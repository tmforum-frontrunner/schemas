{
    "$schema": "http://json-schema.org/draft-07/schema#", 
    "$id": "CustomerBill.schema.json", 
    "title": "CustomerBill", 
    "definitions": {
        "CustomerBill": {
            "type": "object", 
            "description": "The customer bill. Can be a regular recurring bill or an extra bill on demand by the customer or the csp.", 
            "properties": {
                "id": {
                    "type": "string", 
                    "description": "Explanation: Unique identifier of he bill"
                }, 
                "href": {
                    "type": "string", 
                    "description": "Bill unique reference"
                }, 
                "amountDue": {
                    "$ref": "Money.schema.json#/definitions/Money"
                    }, 
                "appliedPayment": {
					"description": "Applied payment is a payment associated with the bill. There may be a partial payment, then there should be several applied payments available. On the other hand, more than one bill could be payed by one payment. In general there is an n:m relation between payment and bill.",
                    "type": "array", 
                    "items": {
                        "$ref": "AppliedPayment.schema.json#/definitions/AppliedPayment"
                    }
                }, 
                "billDate": {
                    "type": "string", 
                    "format": "date-time", 
                    "description": "Bill date, external customer view (in consequence: different to the production date of the bill)"
                }, 
                "billDocument": {
                    "type": "array", 
                    "items": {
                        "$ref": "AttachmentRefOrValue.schema.json#/definitions/AttachmentRefOrValue"
                    }
                }, 
                "billNo": {
                    "type": "string", 
                    "description": "Bill reference known by the customer or the party and displayed on the bill. Could be different from the id"
                }, 
                "billingAccount": {
                    "$ref": "BillingAccountRef.schema.json#/definitions/BillingAccountRef"
                }, 
                "billingPeriod": {
                    "$ref": "TimePeriod.schema.json#/definitions/TimePeriod"
                }, 
                "billCycle": {
                    "$ref": "BillCycleRef.schema.json#/BillCycleRef"
                }, 
                "category": {
                    "type": "string", 
                    "description": "Category of the bill produced : normal, duplicate, interim, last, trial customer or credit note for example"
                }, 
                "financialAccount": {
                    "$ref": "FinancialAccountRef.schema.json#/definitions/FinancialAccountRef"
                }, 
                "lastUpdate": {
                    "type": "string", 
                    "format": "date-time", 
                    "description": "Date of bill last update"
                }, 
                "nextBillDate": {
                    "type": "string", 
                    "format": "date-time", 
                    "description": "). Approximate date of  the next bill production given for information (only used/meaningful for on cycle / regular bills)"
                }, 
                "paymentDueDate": {
                    "type": "string", 
                    "format": "date-time", 
                    "description": "Date at which the amount due should have been paid"
                }, 
                "paymentMethod": {
					"description": "paymentMethod here is recognized to be not really necessary in a STANDARD. It could be obtained by a GET request on the billing account. Conclusion: paymentMethod is marked to DEPRECIATED and will be removed in one of the next versions.",
                    "$ref": "PaymentMethodRef.schema.json#/definitions/PaymentMethodRef"
                }, 
                "relatedParty": {
                    "type": "array", 
                    "items": {
                        "$ref": "RelatedParty.schema.json#/definitions/RelatedParty"
                    }
                }, 
                "remainingAmount": {
                    "$ref": "Money.schema.json#/definitions/Money"
                }, 
                "runType": {
                     "description": "onCycle (a bill can be created as a result of a cycle run) or offCycle (a bill can be created as a result of other events such as customer request or account close)",
 				    "$ref": "CustomerBillRunType.schema.json#/definitions/CustomerBillRunType"                    
                }, 
                "taxExcludedAmount": {
                    "$ref": "Money.schema.json#/definitions/Money"
                }, 
                "taxIncludedAmount": {
                    "$ref": "Money.schema.json#/definitions/Money"
                }, 
                "taxItem": {
                    "type": "array", 
                    "items": {
                        "$ref": "TaxItem.schema.json#/definitions/TaxItem"
                    }
                },
				"state": {
				    "description": "Status of the bill",
				    "$ref": "CustomerBillStateType.schema.json#/definitions/CustomerBillStateType"
                }
            },
       		"allOf": [
				{
					"$ref": "Entity.schema.json#/Entity"
				}
			]

        }
    }
}
